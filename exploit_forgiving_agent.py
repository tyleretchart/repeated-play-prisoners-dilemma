from agent import Agent
import numpy as np

class ExploitForgivingAgent(Agent):
    def __init__(self, player_type):
        super(ExploitForgivingAgent, self).__init__(player_type)
        self.their_actions = [0]
        self.our_actions = [1]
        self.unforgiving = False
    
    def move(self):
        if self.unforgiving:
            return 1
        else:
            return 1 - self.their_actions[-1]


    def record_history(self, row_action, col_action, row_payoff, col_payoff):

        self.their_actions.append(row_action if self.player_type else col_action)
        self.our_actions.append(col_action if self.player_type else row_action)

        if not self.unforgiving and len(self.their_actions) >= 2:
            self.unforgiving = self.their_actions[-1] == 1 and self.our_actions[-2] == 0

